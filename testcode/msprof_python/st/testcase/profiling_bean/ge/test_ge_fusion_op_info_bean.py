import unittest

from profiling_bean.ge.ge_fusion_op_info_bean import GeFusionOpInfoBean

NAMESPACE = 'profiling_bean.struct_info.ge.ge_fusion_op_info_bean'


class TestGeFusionOpInfoBean(unittest.TestCase):

    def test_construct(self):
        bean = GeFusionOpInfoBean()
        binary_data = b'ZZ\x15\x00\x05\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00one_hot\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00 \x01\x00\x00\x00\x00\x00\x00\xa0\xf4\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc0\xf5\x01\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\xe4-\tfl\x84M\xea\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
        bean.fusion_decode(binary_data)
        self.assertEqual(bean.hash_flag, 1)
        self.assertEqual(bean.model_id, 5)
        self.assertEqual(bean.fusion_name,
                         b'one_hot\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00')
        self.assertEqual(bean.input_mem_size, "288")
        self.assertEqual(bean.output_mem_size, "128160")
        self.assertEqual(bean.weight_mem_size, "0")
        self.assertEqual(bean.workspace_mem_size, "0")
        self.assertEqual(bean.total_mem_size, "128448")
        self.assertEqual(bean.fusion_op_num, 1)
        self.assertEqual(bean.fusion_op, '16883296179185069540')
        self.assertEqual(bean.is_hash_type(), False)


if __name__ == '__main__':
    unittest.main()
