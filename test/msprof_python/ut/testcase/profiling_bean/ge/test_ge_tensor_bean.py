import unittest

from profiling_bean.ge.ge_tensor_bean import GeTensorBean

NAMESPACE = 'profiling_bean.struct_info.ge.ge_fusion_op_info_bean'


class TestGeTensorBean(unittest.TestCase):

    def test_construct(self):
        bean = GeTensorBean()
        binary_data = b'ZZ\x18\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\t\x00\x00\x00\x02\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\t\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\t\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00\t\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'

        bean.fusion_decode(binary_data)
        self.assertEqual(bean.input_data_type, 'INT64;INT64')
        self.assertEqual(bean.index_num, 0)
        self.assertEqual(bean.input_format, 'FORMAT_ND;FORMAT_ND')
        self.assertEqual(bean.input_shape,';')
        self.assertEqual(bean.model_id,1)
        self.assertEqual(bean.output_data_type, 'INT64')
        self.assertEqual(bean.output_format, 'FORMAT_ND')
        self.assertEqual(bean.output_shape, '')
        self.assertEqual(bean.stream_id, 9)
        self.assertEqual(bean.task_id, 2)
        self.assertEqual(bean.tensor_num, 3)
        self.assertEqual(bean.tensor_type, 0)


if __name__ == '__main__':
    unittest.main()
