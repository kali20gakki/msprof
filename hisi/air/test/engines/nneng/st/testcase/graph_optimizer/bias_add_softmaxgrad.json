{
    "Rules":[
        {
            "RuleName":"SoftmaxGrad_Fusion",
            "OuterInputs":[
                {
                    "name":"grad_softmax"
                },
                {
                    "name":"softmax"
                }
            ],
            "OuterOutputs":[
                {
                    "name":"grad_x"
                }
            ],
            "OriginGraph":{
                "Nodes":[
                    {
                        "name":"mul_1",
                        "type":[
                            "Mul"
                        ]
                    },
                    {
                        "name":"sum",
                        "type":[
                            "ReduceSumD"
                        ]
                    },
                    {
                        "name":"mul_2",
                        "type":[
                            "Mul"
                        ]
                    }
                ],
                "Edges":[
                    {
                        "src":"grad_softmax",
                        "dst":"mul_1:0"
                    },
                    {
                        "src":"softmax",
                        "dst":"mul_1:1"
                    },
                    {
                        "src":"mul_1:0",
                        "dst":"sum:0"
                    },
                    {
                        "src":"sum:0",
                        "dst":"mul_2:0"
                    },
                    {
                        "src":"softmax",
                        "dst":"mul_2:1"
                    },
                    {
                        "src":"mul_2:0",
                        "dst":"grad_x"
                    }
                ]
            },
            "FusionGraph":{
                "Nodes":[
                    {
                        "name":"softmaxgrad",
                        "type":[
                            "SoftmaxGrad"
                        ]
                    }
                ],
                "Edges":[
                    {
                        "src":"grad_softmax",
                        "dst":"softmaxgrad:0"
                    },
                    {
                        "src":"softmax",
                        "dst":"softmaxgrad:1"
                    },
                    {
                        "src":"softmaxgrad:0",
                        "dst":"grad_x"
                    }
                ],
                "Attrs":[
                    {
                        "attr":"softmaxgrad.axis",
                        "value":"sum.axis",
                        "expr":"="
                    }
                ]
            }
        },
        {
            "RuleName":"MatMul_BiasAdd_Fusion",
            "OuterInputs":[
                {
                    "name":"features"
                },
                {
                    "name":"weight"
                },
                {
                    "name":"bias"
                }
            ],
            "OuterOutputs":[
                {
                    "name":"y"
                }
            ],
            "OriginGraph":{
                "Nodes":[
                    {
                        "name":"matmul",
                        "type":[
                            "MatMul"
                        ]
                    },
                    {
                        "name":"biasadd",
                        "type":[
                            "BiasAdd"
                        ]
                    }
                ],
                "Edges":[
                    {
                        "src":"features",
                        "dst":"matmul:0"
                    },
                    {
                        "src":"weight",
                        "dst":"matmul:1"
                    },
                    {
                        "src":"matmul:0",
                        "dst":"biasadd:0"
                    },
                    {
                        "src":"bias",
                        "dst":"biasadd:1"
                    },
                    {
                        "src":"biasadd:0",
                        "dst":"y"
                    }
                ]
            },
            "FusionGraph":{
                "Nodes":[
                    {
                        "name":"matmul",
                        "type":[
                            "MatMul"
                        ]
                    }
                ],
                "Edges":[
                    {
                        "src":"features",
                        "dst":"matmul:0"
                    },
                    {
                        "src":"weight",
                        "dst":"matmul:1"
                    },
                    {
                        "src":"bias",
                        "dst":"matmul:2"
                    },
                    {
                        "src":"matmul:0",
                        "dst":"y"
                    }
                ],
                "Attrs":[
                    {
                        "attr":"matmul.has_bias",
                        "value":"true",
                        "expr":"="
                    }
                ]
            }
        }
    ]
}
